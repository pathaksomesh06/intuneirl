---
title: "Managing Rapid Security Response on Apple Devices"
date: 2023-05-03T09:48:32"
draft: false
tags: []
---

<p>The latest version of <em>iOS/iPadOS 16.4.1 (a)</em> and <em>macOS 13.3.1 (a)</em> marks a significant change in how Apple releases updates for the OS updates. It is the first time that <strong>Rapid Security Response (RSR)</strong> has been included in the OS for iPhones, iPads and macOS. These latest updates come with a new feature called <strong>Rapid Security Response</strong>. This mechanism enables faster delivery of security updates to devices, allowing more frequent and timely fixes to security vulnerabilities. RSRs are included in the ensuing minor updates (not upgrades), and on a Mac, updated content appears on the Preboot volume.</p><p>There was a lot of excitement surrounding the launch of the RSR from Apple after its initial announcement; however, the actual release was fraught with difficulties and unforeseen challenges, resulting in a tumultuous experience for all involved. Here are a few of them to list:</p><ul><li>A completely new naming convention for OS.</li><li>Compliance policies in Microsoft Intune are not ready yet to adapt to the new naming convention.</li><li>Issues with rules &amp; policies configured in Microsoft Defender for Endpoint.</li><li>Conditional Access Policies caused issues due to new iOS/iPadOS or macOS build numbers.</li></ul><p>To begin with, it is essential to understand the new updates and how they can be managed on supervised devices. It is crucial to know the install behaviour and how to control it for the best results.</p><hr><h2 id="overview">Overview:</h2><p><em>Rapid Security Response</em>, aka <em>RSR</em>, are released by Apple to deliver critical security updates between software upgrades — for example, improvements to the Safari web browser, the WebKit framework stack, or other critical system libraries. They may also be used to mitigate some security issues more quickly, such as issues that might have been exploited or reported to exist "in the wild."</p><blockquote>New Rapid Security Responses are delivered only for the latest version of iOS, iPadOS and macOS — beginning with iOS 16.4.1, iPadOS 16.4.1, and macOS 13.3.1.</blockquote><p>I have attempted to break down the information into separate points to fully understand the rapid security updates.</p><ul><li>Rapid Security Responses that are intended for the operating system <u><em>require the device to restart</em></u>. </li><li>If enabled, these responses can happen <u><em>automatically without requiring permission from the user</em></u>. (If the response is not for OS) </li><li>Once the device requests the Rapid Security Response update, it will be downloaded; it only gives users a <strong><em>10-second window to click "Not Now</em></strong>".</li><li>The update takes approximately <strong><em>5-10 mins</em></strong> (depending on your internet connection) from start to restart finish.</li><li>The update download is around <em><u><strong>85MB</strong></u></em>, and the installation takes a bit longer, but the restart is relatively quick.</li><li>On macOS, the updated operating system content may be made available to Safari and its associated processes with just a relaunch of those processes. However, <u><em>a restart is required to make this content broadly available to the rest of the operating system</em></u>.</li><li>On iOS &amp; iPad OS, it <u><em>may need to restart enterprise applications</em></u> if they were being used in the foreground. So it may lead to data loss if not handled properly.</li><li>Users, <u>by default, have the option to uninstall</u>, i.e. remove the responses.</li><li>Rapid Security Responses <em><u>don’t adhere to the managed software update delay</u></em>.</li><li>If you have <u><em>enforced a software deferral policy from Microsoft Intune</em></u>, then the response is also effectively delayed because they apply only to the latest minor operating system version.</li></ul><hr><p>Now, let's review the process at the device level in more detail:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-9.png" class="kg-image" alt="Security Response available to the device" loading="lazy" width="912" height="728" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-9.png 600w, __GHOST_URL__/content/images/2023/05/image-9.png 912w" sizes="(min-width: 720px) 720px"><figcaption>Security Response available to the device</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-8.png" class="kg-image" alt="Device requests for downloading the Security Response" loading="lazy" width="623" height="686" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-8.png 600w, __GHOST_URL__/content/images/2023/05/image-8.png 623w"><figcaption>Device requests for downloading the Security Response</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-10.png" class="kg-image" alt="Device start receiving the response from Apple Servers" loading="lazy" width="626" height="672" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-10.png 600w, __GHOST_URL__/content/images/2023/05/image-10.png 626w"><figcaption>The device starts receiving the response from Apple Servers</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-11.png" class="kg-image" alt="10-second window to click &quot;Not Now&quot;" loading="lazy" width="1273" height="1703" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-11.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-11.png 1000w, __GHOST_URL__/content/images/2023/05/image-11.png 1273w" sizes="(min-width: 720px) 720px"><figcaption><em>10-second window to click "Not Now</em>"</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-12.png" class="kg-image" alt loading="lazy" width="1265" height="1651" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-12.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-12.png 1000w, __GHOST_URL__/content/images/2023/05/image-12.png 1265w" sizes="(min-width: 720px) 720px"><figcaption>The device verifies the update and prepares for restart.</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-13.png" class="kg-image" alt="The device restarts, and the latest response is installed." loading="lazy" width="1269" height="823" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-13.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-13.png 1000w, __GHOST_URL__/content/images/2023/05/image-13.png 1269w" sizes="(min-width: 720px) 720px"><figcaption>The device restarts, and the latest response is installed.</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-14.png" class="kg-image" alt="User can remove the response also" loading="lazy" width="578" height="881"><figcaption>Users can remove the response by navigating to device Settings-&gt;About.</figcaption></figure><hr><h2 id="manage-rapid-security-response-with-mdm">Manage Rapid Security Response with MDM</h2><p>When managing supervised devices, you have multiple options to modify settings related to rapid security response. These options ensure that mobile devices are secure and protected from potential threats. Let's look at all the possible approaches to handling Rapid Security Response policies.</p><p>Apple provides the following restriction keys to be used on supervised iPhone and iPad devices for managing the responses:</p><ul><li><code>allowRapidSecurityResponseInstallation</code></li><li><code>allowRapidSecurityResponseRemoval</code></li></ul><ol><li>The <code>allowRapidSecurityResponseRemoval</code> restriction key can block or allow a user to remove responses from the device.</li><li>Setting <code>CriticalUpdateInstall</code> to "<em>true" </em>enables rapid security response in macOS.</li><li><code>Device Info</code> and <code>AvailableOSUpdate</code> queries can be used for reporting the status of Rapid Security Response to Microsoft Intune.</li><li><code>allowRapidSecurityResponseInstallation</code> restriction key allows admins to disable Rapid Security Response, which is enabled by default.</li></ol><h3 id="manage-rsr-using-settings-catalog">Manage RSR using Settings Catalog</h3><p>The settings catalog lists all the settings you can configure and all in one place. This feature simplifies how you create a policy and how you see all the available settings. Follow the below steps to configure the policy for responses:</p><ul><li>Sign in to the <a href="https://intune.microsoft.com">Microsoft Intune admin center</a>.</li><li>Navigate to <strong>Devices</strong> &gt; <strong>iOS/iPadOS devices</strong> &gt;<strong>Create Profile</strong> &gt; <strong>Settings Catalog &gt; Create.</strong></li><li>Enter a descriptive name for the profile and click <strong>Next.</strong></li></ul><figure class="kg-card kg-image-card"><img src="__GHOST_URL__/content/images/2023/05/image-15.png" class="kg-image" alt loading="lazy" width="1005" height="496" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-15.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-15.png 1000w, __GHOST_URL__/content/images/2023/05/image-15.png 1005w" sizes="(min-width: 720px) 720px"></figure><ul><li>Search for "<strong>Rapid</strong>", and select both options under <strong>Restrictions</strong>.</li></ul><figure class="kg-card kg-image-card"><img src="__GHOST_URL__/content/images/2023/05/image-16.png" class="kg-image" alt loading="lazy" width="1584" height="737" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-16.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-16.png 1000w, __GHOST_URL__/content/images/2023/05/image-16.png 1584w" sizes="(min-width: 720px) 720px"></figure><ul><li>If you are not ready to install Rapid Security Response in your organization, then toggle the "<u><em>Installation</em></u>" option to "<em><u>False</u></em>". Then Rapid Security Response will be disabled for users. This means the RSR will not be visible on the end user's devices. </li></ul><blockquote><u>This is not recommeded, as it will leave the device vunerable to threats!</u></blockquote><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-17.png" class="kg-image" alt="Response installation disabled" loading="lazy" width="1499" height="1293" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-17.png 600w, __GHOST_URL__/content/images/size/w1000/2023/05/image-17.png 1000w, __GHOST_URL__/content/images/2023/05/image-17.png 1499w" sizes="(min-width: 720px) 720px"><figcaption>Response installation disabled</figcaption></figure><ul><li>To block users from removing the security response, toggle the "<u><em>Removal</em></u>" option to "<em><u>False</u></em>". When enforced, the users will not see any option to remove the installed update. </li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-18.png" class="kg-image" alt="Response removal is disabled" loading="lazy" width="950" height="642" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-18.png 600w, __GHOST_URL__/content/images/2023/05/image-18.png 950w" sizes="(min-width: 720px) 720px"><figcaption>Response removal is disabled.</figcaption></figure><ul><li>Push the policy to your <u><em>test devices first</em></u>. Review the effects and, when ready, go for a production rollout. </li></ul><h3 id="manage-rsr-using-custom-policy">Manage RSR using Custom Policy</h3><p>Using Microsoft Intune, you can also add or create custom settings for your iOS/iPadOS devices using "custom profiles". There are two ways to get custom settings into Intune:</p><ul><li><a href="https://itunes.apple.com/app/apple-configurator-2/id1037126344?mt=12">Apple Configurator</a></li><li><a href="https://support.apple.com/profile-manager">Apple Profile Manager</a></li></ul><p>Here is the custom profile I am using with Microsoft Intune to manage Rapid Security Response:</p><figure class="kg-card kg-code-card"><pre><code class="language-.xml">&lt;dict&gt;
    &lt;key&gt;allowRapidSecurityResponseInstallation&lt;/key&gt;
    &lt;true /&gt;
    &lt;key&gt;allowRapidSecurityResponseRemoval&lt;/key&gt;
    &lt;false /&gt;
    &lt;key&gt;PayloadDisplayName&lt;/key&gt;
    &lt;string&gt;iOS 16 Restrictions&lt;/string&gt;
    &lt;key&gt;PayloadDescription&lt;/key&gt;
    &lt;string&gt;Restrictions&lt;/string&gt;
    &lt;key&gt;PayloadOrganization&lt;/key&gt;
    &lt;string&gt;Intune-IRL&lt;/string&gt;
    &lt;key&gt;PayloadType&lt;/key&gt;
    &lt;string&gt;com.apple.applicationaccess&lt;/string&gt;
    &lt;key&gt;PayloadUUID&lt;/key&gt;
    &lt;string&gt;336123456-4E5D-BCE5&lt;/string&gt;
    &lt;key&gt;PayloadVersion&lt;/key&gt;
    &lt;integer&gt;1&lt;/integer&gt;
    &lt;key&gt;PayloadIdentifier&lt;/key&gt;
    &lt;string&gt;com.apple.applicationaccess.336123456-E41D-4E5D-BCE5&lt;/string&gt;
&lt;/dict&gt;</code></pre><figcaption>Custom Profile for managing security response</figcaption></figure><ul><li>Create a custom profile in Intune and upload the .mobileconfig or .xml file created in the previous step.</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-20.png" class="kg-image" alt loading="lazy" width="893" height="724" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-20.png 600w, __GHOST_URL__/content/images/2023/05/image-20.png 893w" sizes="(min-width: 720px) 720px"><figcaption>Upload the custom mobile config file.</figcaption></figure><ul><li>Push the policy to your <u><em>test devices first</em></u>. Review the effects and, when ready, go for a production rollout. </li></ul><hr><h2 id="looking-forward">Looking Forward</h2><p>Allowing major build upgrades on the managed device's without thorough testing and user approval can lead to many adverse outcomes, such as severe disruptions in business applications, unsatisfactory user experience, and significant financial loss. </p><p>Therefore, exercising utmost caution and diligence is imperative when upgrading operating systems. To avoid this, responses are tailored to the minor version of the OS and provided between major updates, ensuring a smooth and seamless experience for the user. However, it seems that the release of these Rapid Security Response updates was too early. MDM systems still need to tweak a few configurations in the back end before these responses can be rolled out at the enterprise level.  </p><p>Microsoft Intune Support team have also released an advisory regarding the same detailing the impact of these new updates.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="__GHOST_URL__/content/images/2023/05/image-22.png" class="kg-image" alt="Notification from Microsoft" loading="lazy" width="719" height="868" srcset="__GHOST_URL__/content/images/size/w600/2023/05/image-22.png 600w, __GHOST_URL__/content/images/2023/05/image-22.png 719w"><figcaption>Notification from Microsoft</figcaption></figure><p>At the time of writing this article and as per my testing, the following configurations are impacted:</p><ul><li>Admins can’t create new compliance policies to check for the new iOS update with an “(a)” added to the version string. <em><u>Existing policy checks are unaffected.</u></em></li><li>Admins <u><em>can’t create a policy to block conditional launches based on OS version</em></u> with the character “(a)” for Mobile Application Management (MAM), is unable to check for the new version and can't validate whether an application can launch or not.</li><li><u><em>Enrollment restriction policies may not work</em></u> as intended with non-numerical character versions for Apple products.</li><li>Reports with build-specific values will report OS without the “(a)”.</li><li>For Mobile Device Management (MDM), admins can use Intune update controls to set the required version to the latest to get the security update.</li></ul><hr><p>Thank you for being with me on this article for configuring the policies for the all-new Rapid Security Response updates. I hope it was helpful and that you will have better control on managing Apple Operating System Updates.</p>